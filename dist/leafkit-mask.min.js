/**
  * Leafkit - Ferramentas Vue para UI
  * 
  * leafkit-mask v0.5.5
  * @license MIT
  * (c) 2018 hvpaiva
  */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.LeafkitMask=t()}(this,function(){"use strict";function e(t){e.installed||(n=t,t.directive("maskDecimal",w),t.directive("maskNumber",b),e.installed=!0)}var t=function(e,t){this.options=t||{},this.options={reverse:this.options.reverse||!1,usedefaults:this.options.usedefaults||this.options.reverse},this.pattern=e};t.prototype.process=function(e,n,r){return new t(n,r).process(e)},t.prototype.apply=function(e,n,r){return new t(n,r).apply(e)},t.prototype.validate=function(e,n,r){return new t(n,r).validate(e)},t.prototype.process=function(e){var t=this;if(!e)return{result:"",valid:!1};e+="";var n=this.pattern,c=!0,f="",l=this.options.reverse?e.length-1:0,v=0,d=a(n,e),h=!1,m=[],g=!1,y={start:this.options.reverse?n.length-1:0,end:this.options.reverse?-1:n.length,inc:this.options.reverse?-1:1};for(v=y.start;function(t){if(!g&&!m.length&&s(n,v,y.inc))return!0;if(!g&&m.length&&u(n,v,y.inc))return!0;if(g||(g=m.length>0),g){var r=m.shift();if(m.push(r),t.reverse&&l>=0)return v++,n=p(n,r,v),!0;if(!t.reverse&&l<e.length)return n=p(n,r,v),!0}return v<n.length&&v>=0}(this.options);v+=y.inc){var w=e.charAt(l),b=n.charAt(v),k=r[b];if(m.length&&k&&!k.recursive&&(k=null),!g||w){if(t.options.reverse&&i(n,v)){f=o(f,b,t.options,k),v+=y.inc;continue}if(!t.options.reverse&&h){f=o(f,b,t.options,k),h=!1;continue}if(!t.options.reverse&&k&&k.escape){h=!0;continue}}if(!g&&k&&k.recursive)m.push(b);else{if(g&&!w){f=o(f,b,t.options,k);continue}if(!g&&m.length>0&&!w)continue}if(k)if(k.optional){if(k.pattern.test(w)&&d)f=o(f,w,t.options,k),l+=y.inc,d--;else if(m.length>0&&w){c=!1;break}}else if(k.pattern.test(w))f=o(f,w,t.options,k),l+=y.inc;else{if(w||!k._default||!t.options.usedefaults){c=!1;break}f=o(f,k._default,t.options,k)}else f=o(f,b,t.options,k),!g&&m.length&&m.push(b)}return{result:f,valid:c}},t.prototype.apply=function(e){return this.process(e).result},t.prototype.validate=function(e){return this.process(e).valid};var n,r={0:{pattern:/\d/,_default:"0"},9:{pattern:/\d/,optional:!0},"#":{pattern:/\d/,optional:!0,recursive:!0},A:{pattern:/[a-zA-Z0-9]/},S:{pattern:/[a-zA-Z]/},U:{pattern:/[a-zA-Z]/,transform:function(e){return e.toLocaleUpperCase()}},L:{pattern:/[a-zA-Z]/,transform:function(e){return e.toLocaleLowerCase()}},$:{escape:!0}},i=function(e,t){for(var n=0,i=t-1,a={escape:!0};i>=0&&a&&a.escape;)a=r[e.charAt(i)],n+=a&&a.escape?1:0,i--;return n>0&&n%2==1},a=function(e,t){var n=e.replace(/[^0]/g,"").length;return t.replace(/[^\d]/g,"").length-n},o=function(e,t,n,r){return r&&"function"==typeof r.transform&&(t=r.transform(t)),n.reverse?t+e:e+t},s=function(e,t,n){var i=e.charAt(t),a=r[i];return""!==i&&(!(!a||a.escape)||s(e,t+n,n))},u=function(e,t,n){var i=e.charAt(t),a=r[i];return""!==i&&(!(!a||!a.recursive)||u(e,t+n,n))},p=function(e,t,n){var r=e.split("");return r.splice(n,0,t),r.join("")},c=function(e,t){return"input"===t.tag?e:e.querySelector("input:not([readonly])")},f=function(e){return e.replace(/\D/g,"")},l=function(e){return e.replace(/[^a-zA-Z]/g,"")},v=function(e){return e.replace(/[^a-zA-Z0-9]/g,"")},d=function(e){if("function"==typeof e)return e;switch(e){case"number":return f;case"letter":return l;default:return v}},h=function(e){var t=e.clean,n=e.format,r=e.formatter;return function(e){var i=e.target,a=e.type,o=e.isTrusted;"paste"===a&&(i.value="");var s=t(i.value);i.value=n({value:s,formatter:r}),i.dataset.value=i.value,("mask"===a||o)&&i.dispatchEvent(new Event("input"))}},m=function(e){var t=e.value;return t=e.formatter.apply(t),t.trim().replace(/[^0-9]$/,"")},g=function(e){return{bind:function(n,r,i){var a=e(n,r,i),o=d(a.clearValue),s=a.format||m,u=a.pattern?new t(a.pattern,a.options||{}):null,p=h({clean:o,format:s,formatter:u});n=c(n,i),n.addEventListener("input",p,!1),n.addEventListener("paste",p,!1),n.addEventListener("blur",p,!1),n.addEventListener("mask",p,!1),p({target:n,type:"mask"})},update:function(e,t,r){e=c(e,r),n.nextTick(function(){(e.dataset.value||"")!==e.value&&e.dispatchEvent(new Event("mask"))})}}},y={br:{thousand:".",decimal:","},us:{thousand:",",decimal:"."}},w=g(function(e,t){var n=t.value,r=t.arg,i=t.modifiers,a=r||Object.keys(i)[0]||"br",o=y[a],s="#"+o.thousand+"##0";if(n&&n>0)for(s+=o.decimal;n>0;)s+="0",n--;return{pattern:s,options:{reverse:!0},clearValue:"number",format:function(e){var t=e.value;return e.formatter.apply(Number(t))}}}),b=g(function(){return{pattern:"#0",options:{reverse:!0},clearValue:"number"}}),k={install:e};return"undefined"!=typeof window&&window.Vue&&window.Vue.use({install:e}),k});